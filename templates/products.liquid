{% comment %}
  Products Listing Template - Kajabi Version
  Displays all products with category filtering
{% endcomment %}

<div class="products-wrapper">
  {% section 'products-header' %}
  
  <div class="container">
    <div class="products-content">
      {% if categories.size > 0 %}
        <aside class="products-filters">
          <h3 class="filters-title">Filter by Category</h3>
          <ul class="filter-list">
            <li class="filter-item">
              <a href="{{ routes.products_url }}" class="filter-link {% unless current_category %}is-active{% endunless %}">
                All Products
              </a>
            </li>
            {% for category in categories %}
              <li class="filter-item">
                <a href="{{ category.url }}" class="filter-link {% if current_category.id == category.id %}is-active{% endif %}">
                  {{ category.title }}
                  <span class="filter-count">({{ category.products.size }})</span>
                </a>
              </li>
            {% endfor %}
          </ul>
        </aside>
      {% endif %}
      
      <div class="products-main">
        <div class="products-toolbar">
          <div class="products-count">
            {{ products.size }} {% if products.size == 1 %}product{% else %}products{% endif %}
          </div>
          
          <div class="products-sort">
            <label for="sort-by" class="visually-hidden">Sort by</label>
            <select id="sort-by" class="sort-select">
              <option value="featured">Featured</option>
              <option value="newest">Newest</option>
              <option value="price-low">Price: Low to High</option>
              <option value="price-high">Price: High to Low</option>
              <option value="title">Alphabetical</option>
            </select>
          </div>
        </div>
        
        <div class="products-grid">
          {% for product in products %}
            {% render 'product-card', product: product %}
          {% endfor %}
        </div>
        
        {% if paginate.pages > 1 %}
          {% render 'pagination', paginate: paginate %}
        {% endif %}
      </div>
    </div>
  </div>
</div>